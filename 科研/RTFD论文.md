# 论文名称：Real-time fruit detection using deep neural networks on CPU (RTFD): An edge AI application

## 提出问题

- 边缘设备的图像处理能力相对较低
- 在现实场景应用物体检测学习算法具有挑战性

## 解决方案

### 提出RTFD 轻量算法进行使用边缘CPU设备检测水果

- 基于PicoDet-S model
- 优化了原有模型的结构、损失函数、激活函数。RTFD使用CIoU边界损失函数、ACON-C激活函数和具有检测头部的三层LC-PAN来平衡模型的正确性和效率
- 对Conv2D和模型的线性层进行8位量化感知训练的方法，以改进边缘部署。这种方法将Conv2D和线性层中的32位浮点值量化为8位整数，从而减少了模型的大小，加快了检测速度。
- 将定量训练的模型转换为Paddle Lite格式在边缘设备上使用。

## 测试效果

模型大小1.33MB，CPU检测时间11FPS

## 存在的问题

### 现实环境问题

- 草莓和番茄产业的劳动密集型性质使得人们很难在短时间内手工收集到所有成熟的水果。
- 农业景观的背景复杂，水果和树叶相互遮蔽，模型存在准确性和检测速度问题。

### 算法硬件问题

- 当前大多数算法具有较高的算术功率要求，导致更高的硬件成本和能源消耗。如何在计算资源有限的设备中实现快速、高度准确的检测和识别，对智能农业的发展具有重要意义。
- 但由于硬件条件较差（硬件计算资源），大部分的高精度的水果检测算法在实践中并不能有效地发挥作用
- 许多用于GPU加速的CUDA库在存储和处理能力明显较低的边缘设备上都不可用

## 研究的问题

寻找平衡模型复杂性和性能之间的折衷方案，开发一种**轻量级**、**高精度**的水果检测算法部署在边缘设备中进行实时水果检测

## 技术路线：

#### 两个阶段：

#### (1)模型训练；

使用草莓和番茄数据集来训练所提出的RTFD模型。利用CIoU边界盒损失函数、ACON-C激活函数和三层LC-PAN架构，对RTFD模型的性能进行了优化。CIoU边界框损失函数可以作为原损失函数遗漏边界框长宽比计算的补充。ACON- C激活函数可以学习参数，自主决定是否激活神经元，学习更重要的果实特征，提高模型的精度。三层LC-PAN架构允许模型更专注于检测农业情况下的中小型目标，从而降低了模型参数的数量，提高了模型的检测速度。

#### (2)模型量化和部署。

将RTFD模型转换为一个Paddle Lite模型，并实现到一个安卓智能手机应用程序中进行测试，实现了高精度的实时检测性能。

## 补充：

原始的PicoDet-S模型采用四级LC-PAN结构设计，在探测器头部有四个尺度分支，主要使用在大型的公共数据集上面

改进原因：因为现实的农业应用场景需要检测的水果类别少，规模小

改进方法：基于PicoDet-S模型设计了一个较轻的网络结构，该模型使用了具有三个探测器头尺度的三层LC-PAN。改进后的模型可以有效地应用于中小型水果场景，减少了模型参数的数量，提高检测速度。





